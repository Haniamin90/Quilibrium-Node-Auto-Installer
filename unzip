#!/bin/bash

# Step 8: Start tmux session and run restart_node.sh
echo "Starting tmux session and running restart_node.sh..."
tmux new -d -s node 'cd /ceremonyclient/node/ && ./restart_node.sh' || { echo "Failed to start tmux session or run restart_node.sh! Exiting..."; exit 1; }

# Step 9: Suspend restart_node.sh after 15 seconds
echo "Suspending restart_node.sh after 15 seconds..."
sleep 15
tmux send-keys -t node C-z || { echo "Failed to suspend restart_node.sh in tmux session! Exiting..."; exit 1; }

# Step 10: Unzip the file
echo "Unzipping the file..."
tmux send-keys -t node 'unzip /ceremonyclient/node/.config/okay.zip' C-m || { echo "Failed to unzip file in tmux session! Exiting..."; exit 1; }

# Step 11: Resume restart_node.sh
echo "Resuming restart_node.sh..."
tmux send-keys -t node 'fg' C-m || { echo "Failed to resume restart_node.sh in tmux session! Exiting..."; exit 1; }

echo "Setup complete."
